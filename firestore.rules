rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {
    match /estimates/{estimateId} {
      // 본인의 UID와 일치하는 문서만 읽고 생성할 수 있음
      allow read: if request.auth != null && resource.data.userId == request.auth.uid;
      allow create: if request.auth != null && request.resource.data.userId == request.auth.uid;
      // 리스트(개수 확인 등) 쿼리는 필터가 UID와 일치해야 함
      allow list: if request.auth != null && resource.data.userId == request.auth.uid;
    }
  }
}